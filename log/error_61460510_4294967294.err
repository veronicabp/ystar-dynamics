/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1966: RuntimeWarning: divide by zero encountered in scalar divide
  return np.sqrt(eigvals[0]/eigvals[-1])
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1871: RuntimeWarning: divide by zero encountered in scalar divide
  return self.mse_model/self.mse_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:955: RuntimeWarning: divide by zero encountered in log
  llf = -nobs2*np.log(2*np.pi) - nobs2*np.log(ssr / nobs) - nobs2
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/stats/stattools.py:50: RuntimeWarning: invalid value encountered in scalar divide
  dw = np.sum(diff_resids**2, axis=axis) / np.sum(resids**2, axis=axis)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1966: RuntimeWarning: divide by zero encountered in scalar divide
  return np.sqrt(eigvals[0]/eigvals[-1])
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
multiprocessing.pool.RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'const'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
                    ^^^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 48, in mapstar
    return list(map(*args))
           ^^^^^^^^^^^^^^^^
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/bootstrap.py", line 27, in process_row
    params, constant, summary = rsi(controls_sub, dummy_vars=dummy_vars)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/rsi.py", line 137, in rsi
    constant = result.params["const"]
               ~~~~~~~~~~~~~^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/series.py", line 1121, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/series.py", line 1237, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'const'
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/run_bootstrap.py", line 9, in <module>
    bootstrap_rsi(data_folder="../data/original", bootstrap_iter=100)
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/bootstrap.py", line 147, in bootstrap_rsi
    run_single_boot_iteration(b, boot_sample, extensions, data_folder, start_date, end_date)
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/bootstrap.py", line 66, in run_single_boot_iteration
    results = pool.map(process_row, args)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 367, in map
    return self._map_async(func, iterable, mapstar, chunksize).get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 774, in get
    raise self._value
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 48, in mapstar
    return list(map(*args))
      ^^^^^^^^^^^^^^^^^
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/bootstrap.py", line 27, in process_row
    params, constant, summary = rsi(controls_sub, dummy_vars=dummy_vars)
      ^^^^^^^^^^^^^^^^^
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/rsi.py", line 137, in rsi
    constant = result.params["const"]
  ^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/series.py", line 1121, in __getitem__
    return self._get_value(key)
^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/series.py", line 1237, in _get_value
    loc = self.index.get_loc(label)
  ^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
^^^^^^^^^^^^^^^
KeyError: 'const'
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1966: RuntimeWarning: divide by zero encountered in scalar divide
  return np.sqrt(eigvals[0]/eigvals[-1])
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1966: RuntimeWarning: divide by zero encountered in scalar divide
  return np.sqrt(eigvals[0]/eigvals[-1])
multiprocessing.pool.RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'const'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
                    ^^^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 48, in mapstar
    return list(map(*args))
           ^^^^^^^^^^^^^^^^
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/bootstrap.py", line 27, in process_row
    params, constant, summary = rsi(controls_sub, dummy_vars=dummy_vars)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/rsi.py", line 137, in rsi
    constant = result.params["const"]
               ~~~~~~~~~~~~~^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/series.py", line 1121, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/series.py", line 1237, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'const'
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/run_bootstrap.py", line 9, in <module>
    bootstrap_rsi(data_folder="../data/original", bootstrap_iter=100)
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/bootstrap.py", line 147, in bootstrap_rsi
    run_single_boot_iteration(b, boot_sample, extensions, data_folder, start_date, end_date)
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/bootstrap.py", line 66, in run_single_boot_iteration
    results = pool.map(process_row, args)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 367, in map
    return self._map_async(func, iterable, mapstar, chunksize).get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 774, in get
    raise self._value
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 48, in mapstar
    return list(map(*args))
      ^^^^^^^^^^^^^^^^^
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/bootstrap.py", line 27, in process_row
    params, constant, summary = rsi(controls_sub, dummy_vars=dummy_vars)
      ^^^^^^^^^^^^^^^^^
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/rsi.py", line 137, in rsi
    constant = result.params["const"]
  ^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/series.py", line 1121, in __getitem__
    return self._get_value(key)
^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/series.py", line 1237, in _get_value
    loc = self.index.get_loc(label)
  ^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
^^^^^^^^^^^^^^^
KeyError: 'const'
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
multiprocessing.pool.RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'const'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
                    ^^^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 48, in mapstar
    return list(map(*args))
           ^^^^^^^^^^^^^^^^
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/bootstrap.py", line 27, in process_row
    params, constant, summary = rsi(controls_sub, dummy_vars=dummy_vars)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/rsi.py", line 137, in rsi
    constant = result.params["const"]
               ~~~~~~~~~~~~~^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/series.py", line 1121, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/series.py", line 1237, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'const'
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/run_bootstrap.py", line 9, in <module>
    bootstrap_rsi(data_folder="../data/original", bootstrap_iter=100)
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/bootstrap.py", line 147, in bootstrap_rsi
    run_single_boot_iteration(b, boot_sample, extensions, data_folder, start_date, end_date)
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/bootstrap.py", line 66, in run_single_boot_iteration
    results = pool.map(process_row, args)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 367, in map
    return self._map_async(func, iterable, mapstar, chunksize).get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 774, in get
    raise self._value
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 48, in mapstar
    return list(map(*args))
      ^^^^^^^^^^^^^^^^^
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/bootstrap.py", line 27, in process_row
    params, constant, summary = rsi(controls_sub, dummy_vars=dummy_vars)
      ^^^^^^^^^^^^^^^^^
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/rsi.py", line 137, in rsi
    constant = result.params["const"]
  ^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/series.py", line 1121, in __getitem__
    return self._get_value(key)
^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/series.py", line 1237, in _get_value
    loc = self.index.get_loc(label)
  ^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
^^^^^^^^^^^^^^^
KeyError: 'const'
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
multiprocessing.pool.RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'const'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
                    ^^^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 48, in mapstar
    return list(map(*args))
           ^^^^^^^^^^^^^^^^
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/bootstrap.py", line 27, in process_row
    params, constant, summary = rsi(controls_sub, dummy_vars=dummy_vars)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/rsi.py", line 137, in rsi
    constant = result.params["const"]
               ~~~~~~~~~~~~~^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/series.py", line 1121, in __getitem__
    return self._get_value(key)
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/series.py", line 1237, in _get_value
    loc = self.index.get_loc(label)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'const'
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/run_bootstrap.py", line 9, in <module>
    bootstrap_rsi(data_folder="../data/original", bootstrap_iter=100)
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/bootstrap.py", line 147, in bootstrap_rsi
    run_single_boot_iteration(b, boot_sample, extensions, data_folder, start_date, end_date)
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/bootstrap.py", line 66, in run_single_boot_iteration
    results = pool.map(process_row, args)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 367, in map
    return self._map_async(func, iterable, mapstar, chunksize).get()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 774, in get
    raise self._value
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/multiprocessing/pool.py", line 48, in mapstar
    return list(map(*args))
      ^^^^^^^^^^^^^^^^^
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/bootstrap.py", line 27, in process_row
    params, constant, summary = rsi(controls_sub, dummy_vars=dummy_vars)
      ^^^^^^^^^^^^^^^^^
  File "/nfs/home2/vbperal/research/ystar-dynamics/code/clean/rsi.py", line 137, in rsi
    constant = result.params["const"]
  ^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/series.py", line 1121, in __getitem__
    return self._get_value(key)
^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/series.py", line 1237, in _get_value
    loc = self.index.get_loc(label)
  ^^^^^^^^^^^^^^^^^
  File "/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/pandas/core/indexes/base.py", line 3812, in get_loc
    raise KeyError(key) from err
^^^^^^^^^^^^^^^
KeyError: 'const'
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1966: RuntimeWarning: divide by zero encountered in scalar divide
  return np.sqrt(eigvals[0]/eigvals[-1])
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/stats/stattools.py:125: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  skew = stats.skew(resids, axis=axis)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/stats/stattools.py:126: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  kurtosis = 3 + stats.kurtosis(resids, axis=axis)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1717: RuntimeWarning: divide by zero encountered in scalar divide
  return np.dot(wresid, wresid) / self.df_resid
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: divide by zero encountered in divide
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1795: RuntimeWarning: invalid value encountered in scalar multiply
  return 1 - (np.divide(self.nobs - self.k_constant, self.df_resid)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/regression/linear_model.py:1966: RuntimeWarning: divide by zero encountered in scalar divide
  return np.sqrt(eigvals[0]/eigvals[-1])
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/stats/stattools.py:125: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  skew = stats.skew(resids, axis=axis)
/home/vbperal/miniconda3/envs/ystar/lib/python3.12/site-packages/statsmodels/stats/stattools.py:126: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  kurtosis = 3 + stats.kurtosis(resids, axis=axis)
slurmstepd: error: *** JOB 61460510 ON node119 CANCELLED AT 2024-12-28T05:18:40 DUE TO TIME LIMIT ***
